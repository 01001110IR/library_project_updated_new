<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Update the path for the CSS file -->
    <link rel="stylesheet" href="/library_project_updated/static/bookspage.css">

    <!-- Include Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    
    <title>Create Loan</title>
</head>
<body>
    <h1 class="page-title">Create Loan</h1>
    <table>
        <thead>
            <tr>
                <th>Insert Book ID</th>
                <th>Insert Customer ID</th>
                <th>Choose date to start the loan</th>
                <th>Choose date to return the loan</th>
                <th>Check to Confirm the Loan</th>
                <th>Press to Confirm</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><input type="text" id="book_id"></td>
                <td><input type="text" id="customer_id"></td>
                <td><input type="date" id="start_date"></td>
                <td><input type="date" id="return_date"></td>
                <td><input type="checkbox" id="confirm_loan"></td>
                <td><button onclick="confirmLoan()">Confirm</button></td>
            </tr>
        </tbody>
    </table>

    <!-- Include Axios script for making requests -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    
    <script>
const MY_SERVER = 'http://127.0.0.1:5000'
        // Function to create a table row for customers, books, or loans
        function createTableRow(data, tableBody) {
            data.forEach(item => {
                const row = document.createElement("tr");
                for (const key in item) {
                    const cell = document.createElement("td");
                    cell.textContent = item[key];
                    row.appendChild(cell);
                }
                tableBody.appendChild(row);
            });
        }

        // Function to confirm a loan using Axios
        function confirmLoan() {
            const bookId = document.getElementById('book_id').value;
            const customerId = document.getElementById('customer_id').value;
            const startDate = document.getElementById('start_date').value;
            const returnDate = document.getElementById('return_date').value;
            const confirmLoan = document.getElementById('confirm_loan').checked;

            if (!confirmLoan) {
                alert('Please check the "Confirm Loan" checkbox.');
                return;
            }

            const loanData = {
                book_id: bookId,
                customer_id: customerId,
                returnDate: returnDate,
            };

            axios.post(`${MY_SERVER}/loans`, loanData)
                .then(response => {
                    console.log('Loan confirmed:', response.data);
                    // You can update your UI or perform further actions here
                })
                .catch(error => {
                    console.error('Error confirming loan:', error);
                });
        }
    </script>
</body>
</html>
